---
phase: 10-dashboard-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/metric-card.tsx
  - src/components/ui/collapsible.tsx
  - src/app/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can identify critical information (active threats, brand count) within 3 seconds"
    - "Dashboard shows only essential metrics by default (4-5 primary stats)"
    - "User can expand Quick Actions section to reveal secondary actions"
    - "Dashboard works in both light and dark themes"
  artifacts:
    - path: "src/components/ui/metric-card.tsx"
      provides: "Standardized metric display component"
      exports: ["MetricCard"]
    - path: "src/components/ui/collapsible.tsx"
      provides: "Progressive disclosure primitive"
      exports: ["Collapsible"]
    - path: "src/app/dashboard/page.tsx"
      provides: "Refactored dashboard with F-pattern layout"
      contains: "MetricCard"
  key_links:
    - from: "src/app/dashboard/page.tsx"
      to: "src/components/ui/metric-card.tsx"
      via: "import"
      pattern: "import.*MetricCard"
    - from: "src/app/dashboard/page.tsx"
      to: "src/components/ui/collapsible.tsx"
      via: "import"
      pattern: "import.*Collapsible"
---

<objective>
Restructure dashboard for scannability and reduced cognitive load using F-pattern layout and progressive disclosure.

Purpose: Enable users to assess brand protection status within 3 seconds, reducing cognitive load through clear visual hierarchy.
Output: MetricCard component, Collapsible component, refactored dashboard page with F-pattern layout and progressive disclosure.
</objective>

<execution_context>
@/home/dobsondev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dobsondev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-dashboard-cleanup/10-RESEARCH.md

@src/app/dashboard/page.tsx
@src/components/ui/card.tsx
@src/components/ui/empty-state.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MetricCard and Collapsible components</name>
  <files>
    src/components/ui/metric-card.tsx
    src/components/ui/collapsible.tsx
  </files>
  <action>
Create two new UI primitives:

**MetricCard (src/components/ui/metric-card.tsx):**
- Props: icon (LucideIcon), label (string), value (string|number), detail? (string), variant? ('default'|'critical'|'success'|'warning')
- Layout: Card with icon-left, label-value-detail stacked right
- Variant styles:
  - default: bg-primary-100 text-primary-600 (icon container) - use dark mode compatible: dark:bg-primary-900 dark:text-primary-400
  - critical: bg-red-100 text-red-600 / dark:bg-red-900/30 dark:text-red-400
  - success: bg-green-100 text-green-600 / dark:bg-green-900/30 dark:text-green-400
  - warning: bg-yellow-100 text-yellow-600 / dark:bg-yellow-900/30 dark:text-yellow-400
- Typography: label=text-sm text-muted-foreground, value=text-2xl font-bold text-foreground, detail=text-xs text-muted-foreground

**Collapsible (src/components/ui/collapsible.tsx):**
- Props: trigger (string), defaultOpen? (boolean), children (ReactNode)
- Use useState for open state
- Button with w-full, flex justify-between, aria-expanded={isOpen}
- ChevronDown icon that rotates 180deg when open (transition-transform)
- Render children only when isOpen
- Styling: border border-border rounded-lg, hover:bg-muted transition-colors
- Accessible: proper button semantics, aria-expanded

Both components use cn() from @/lib/utils for class merging.
  </action>
  <verify>
    - `npm run build` compiles without errors
    - Both files export named components
    - TypeScript shows no type errors in either file
  </verify>
  <done>
    - MetricCard renders with all 4 variants correctly
    - Collapsible expands/collapses with smooth transition and chevron rotation
    - Both components use semantic tokens and work in dark mode
  </done>
</task>

<task type="auto">
  <name>Task 2: Refactor dashboard with F-pattern layout and progressive disclosure</name>
  <files>src/app/dashboard/page.tsx</files>
  <action>
Refactor the dashboard page to improve scannability:

**1. Import new components:**
- Import MetricCard from @/components/ui/metric-card
- Import Collapsible from @/components/ui/collapsible

**2. Replace stats grid with MetricCard components:**
Current 4-card grid stays but uses MetricCard for consistency:
- Top-left (F-pattern priority): Active Threats with AlertTriangle icon, variant="critical" if criticalThreats > 0
- Top-right: Brands Monitored with Shield icon, variant="default"
- Bottom-left: Domains Scanned with Globe icon, variant="default"
- Bottom-right: Threats Resolved with CheckCircle icon, variant="success"

Include detail prop for critical count on Active Threats: `detail={stats.criticalThreats > 0 ? \`${stats.criticalThreats} critical\` : undefined}`

**3. Move Quick Actions into Collapsible:**
Wrap the current "Quick Actions" Card content in a Collapsible:
```tsx
<Collapsible trigger="Quick Actions" defaultOpen={false}>
  {/* existing quick action buttons */}
</Collapsible>
```
This declutters the sidebar while keeping actions accessible.

**4. Move Protection Score into Collapsible:**
Wrap the Protection Score card content in a Collapsible:
```tsx
<Collapsible trigger="Protection Score" defaultOpen={false}>
  {/* existing protection score content */}
</Collapsible>
```

**5. Keep primary content visible:**
- Stats grid: ALWAYS visible (critical metrics)
- Recent Threats: ALWAYS visible (actionable items)
- Your Brands: ALWAYS visible (primary navigation)
- Quick Actions: COLLAPSED by default (secondary)
- Protection Score: COLLAPSED by default (informational)

**6. Verify theme support:**
All colors should use semantic tokens (already done from Phase 8/9) but verify:
- text-foreground for primary text
- text-muted-foreground for secondary text
- bg-card for card backgrounds
- border-border for borders

Do NOT change the OnboardingFlow component - leave it as-is.
  </action>
  <verify>
    - `npm run build` compiles without errors
    - `npm run dev` and visit http://localhost:3000/dashboard shows:
      - 4 metric cards at top in grid
      - Quick Actions collapsed by default
      - Protection Score collapsed by default
      - Recent Threats and Your Brands visible
  </verify>
  <done>
    - Dashboard loads with clear F-pattern hierarchy (stats top-left to bottom-right)
    - Quick Actions and Protection Score are collapsed by default
    - User can expand collapsed sections
    - All content works in both light and dark themes
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build` exits 0
2. Dashboard loads without console errors
3. MetricCard displays all 4 variants with correct colors
4. Collapsible expands/collapses with animation
5. F-pattern layout: most important metric (Active Threats) top-left
6. Progressive disclosure: Quick Actions and Protection Score collapsed
7. Theme support: Toggle dark mode, verify all elements readable
</verification>

<success_criteria>
- [ ] MetricCard component created with 4 variants
- [ ] Collapsible component created with accessible expand/collapse
- [ ] Dashboard uses MetricCard for stats grid
- [ ] Quick Actions wrapped in Collapsible (defaultOpen=false)
- [ ] Protection Score wrapped in Collapsible (defaultOpen=false)
- [ ] Recent Threats and Your Brands remain visible by default
- [ ] Build passes, no TypeScript errors
- [ ] Works in both light and dark themes
</success_criteria>

<output>
After completion, create `.planning/phases/10-dashboard-cleanup/10-01-SUMMARY.md`
</output>
