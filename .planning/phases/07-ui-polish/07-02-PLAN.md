---
phase: 07-ui-polish
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - src/app/dashboard/loading.tsx
  - src/app/dashboard/threats/loading.tsx
  - src/app/dashboard/brands/loading.tsx
  - src/app/dashboard/page.tsx
  - src/app/dashboard/threats/page.tsx
  - src/app/dashboard/brands/page.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard routes show skeleton UI while loading (not just spinner)"
    - "Empty lists show EmptyState component with icon, message, and action"
    - "Threats list empty state offers 'Run a scan' action"
    - "Brands list empty state offers 'Add brand' action"
  artifacts:
    - path: "src/app/dashboard/loading.tsx"
      provides: "Dashboard loading skeleton"
      min_lines: 20
    - path: "src/app/dashboard/threats/loading.tsx"
      provides: "Threats page loading skeleton"
      min_lines: 15
    - path: "src/app/dashboard/brands/loading.tsx"
      provides: "Brands page loading skeleton"
      min_lines: 15
  key_links:
    - from: "src/app/dashboard/page.tsx"
      to: "src/components/ui/empty-state.tsx"
      via: "import and render"
      pattern: "import.*EmptyState"
    - from: "src/app/dashboard/threats/page.tsx"
      to: "src/components/ui/empty-state.tsx"
      via: "import and render"
      pattern: "import.*EmptyState"
---

<objective>
Add skeleton loading states and apply EmptyState component across dashboard pages.

Purpose: Replace centered spinners with skeleton UIs that match content layout, and standardize empty state handling.
Output: Loading.tsx files for key routes + updated pages using EmptyState.
</objective>

<execution_context>
@/home/dobsondev/.claude/get-shit-done/workflows/execute-plan.md
@/home/dobsondev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-ui-polish/07-RESEARCH.md
@.planning/phases/07-ui-polish/07-01-SUMMARY.md
@src/app/dashboard/page.tsx
@src/app/dashboard/threats/page.tsx
@src/app/dashboard/brands/page.tsx
@src/components/ui/skeleton.tsx
@src/components/ui/empty-state.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create loading.tsx files for dashboard routes</name>
  <files>src/app/dashboard/loading.tsx, src/app/dashboard/threats/loading.tsx, src/app/dashboard/brands/loading.tsx</files>
  <action>
Create Next.js loading.tsx files using skeleton components from Plan 01:

1. src/app/dashboard/loading.tsx:
   - Header skeleton: h-8 w-1/4 for title, h-4 w-1/3 for subtitle
   - Stats grid: 4 StatSkeleton components in grid-cols-2 lg:grid-cols-4 gap-4
   - Main content: CardSkeleton (col-span-2) + sidebar CardSkeleton
   - Wrap in same layout structure as actual page (space-y-8)

2. src/app/dashboard/threats/loading.tsx:
   - Header skeleton: h-8 w-1/4 for title, h-4 w-1/3 for stats line
   - Filter card skeleton: h-10 w-full for search, 3x h-10 w-32 for selects
   - ListSkeleton with 6 rows in Card wrapper

3. src/app/dashboard/brands/loading.tsx:
   - Header skeleton: h-8 w-1/4 for title
   - Grid of 3 CardSkeleton components

All loading files:
- Export default function Loading()
- Use existing Card components for structure
- Import from '@/components/ui/skeleton'
- Match exact layout of real pages for seamless transition
  </action>
  <verify>
Visit /dashboard, /dashboard/threats, /dashboard/brands with network throttling
Skeleton appears before content loads
No layout shift when content replaces skeleton
  </verify>
  <done>
All three routes show skeleton loading UI instead of centered spinner
Skeleton structure matches actual content layout
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply EmptyState to dashboard pages</name>
  <files>src/app/dashboard/page.tsx, src/app/dashboard/threats/page.tsx, src/app/dashboard/brands/page.tsx</files>
  <action>
Replace inline empty state markup with EmptyState component:

1. src/app/dashboard/page.tsx:
   - "Recent Threats" section: Replace inline Shield icon + text with:
     EmptyState icon={Shield} title="No threats detected" description="Run a scan to check for potential threats" variant="success"
   - Keep existing inline loading spinner (client component needs it for client-side fetch)

2. src/app/dashboard/threats/page.tsx:
   - Replace inline AlertTriangle + text with:
     EmptyState icon={AlertTriangle} title="No threats found" description={dynamicMessage} action={{label: "Run a scan", href: "/dashboard/brands"}}
   - Dynamic message: if filters active "Try adjusting your filters", else "No threats have been detected yet"

3. src/app/dashboard/brands/page.tsx:
   - If brands.length === 0, show:
     EmptyState icon={Shield} title="No brands yet" description="Add your first brand to start monitoring" action={{label: "Add Brand", href: "/dashboard/brands/new"}}

Import EmptyState from '@/components/ui/empty-state'.
Do NOT change loading spinner behavior in client components (keep Loader2 for client-side state loading).
  </action>
  <verify>
Navigate to each page with empty data
EmptyState renders with correct icon, title, description, action
Action button/link navigates correctly
  </verify>
  <done>
All empty list states use consistent EmptyState component
Each empty state has appropriate action to resolve (add brand, run scan, etc.)
  </done>
</task>

</tasks>

<verification>
1. Loading states: Throttle network, navigate to routes, see skeletons
2. Empty states: With empty data, see EmptyState components
3. No regressions: Pages with data still render correctly
</verification>

<success_criteria>
- Dashboard, threats, brands routes have loading.tsx files
- Empty lists show EmptyState with icon + title + description + action
- Skeleton structure matches actual page layout
- No TypeScript errors: `npx tsc --noEmit`
</success_criteria>

<output>
After completion, create `.planning/phases/07-ui-polish/07-02-SUMMARY.md`
</output>
